{namespace neos=Neos\Neos\ViewHelpers}
<f:layout name="BackendSubModule" />

<f:section name="content">
<div class="neos-row-fluid">
  <legend><neos:backend.translate id="packages.index.legend" source="Modules" package="Neos.Neos" /></legend>
  <br />
  <table class="neos-table">
		<thead>
			<tr>
				<th title="{neos:backend.translate(id: 'packages.sortBy.packageName', source: 'Modules', package: 'Neos.Neos')}">
					<f:render section="headerLabel" arguments="{
						sortDirection: sortDirection,
						sortBy: sortBy,
						sortingField: 'name',
						labelIdentifier: 'packages.name'
					}" />
				</th>
				<th title="{neos:backend.translate(id: 'packages.sortBy.packageVersion', source: 'Modules', package: 'Neos.Neos')}">
					<f:render section="headerLabel" arguments="{
						sortDirection: sortDirection,
						sortBy: sortBy,
						sortingField: 'version',
						labelIdentifier: 'packages.version'
					}" />
				</th>
				<th title="{neos:backend.translate(id: 'packages.sortBy.packageKey', source: 'Modules', package: 'Neos.Neos')}">
					<f:render section="headerLabel" arguments="{
						sortDirection: sortDirection,
						sortBy: sortBy,
						sortingField: 'sanitizedPackageKey',
						labelIdentifier: 'packages.key'
					}" />
				</th>
				<th title="{neos:backend.translate(id: 'packages.sortBy.packageType', source: 'Modules', package: 'Neos.Neos')}">
					<f:render section="headerLabel" arguments="{
						sortDirection: sortDirection,
						sortBy: sortBy,
						sortingField: 'type',
						labelIdentifier: 'packages.type'
					}" />
				</th>
				<th class="neos-aCenter neos-span1">
					Frozen
				</th>
			</tr>
		</thead>
    <tbody>
      <f:for each="{packageGroups}" key="packageGroup" as="packages">
        <tr class="neos-folder" id="{packageGroup}">
          <td class="neos-priority1">
            <strong>{packageGroup}</strong>
          </td>
          <td class="neos-priority2">&nbsp;</td>
          <td class="neos-priority3">&nbsp;</td>
          <td class="neos-priority3">&nbsp;</td>
          <td class="neos-priority1"> </td>
          <td class="neos-priority1"> </td>
        </tr>
        <f:for each="{packages}" key="packageKey" as="package">
          <tr class="fold-{packageGroup}"{f:if(condition: package.description, then: ' title="{package.description}"')} data-neos-toggle="tooltip">
            <td class="package-name neos-priority1">
              <label for="{packageKey}">
                <span class="neos-label">{package.name}</span>
              </label>
            </td>
            <td class="package-version neos-priority2">
              <label for="{packageKey}">
                {f:if(condition: package.version, then: '{package.version}', else: '&nbsp;')}
              </label>
            </td>
            <td class="package-key neos-priority3">
              <label for="{packageKey}">
                <span class="neos-label">{packageKey}</span>
              </label>
            </td>
            <td class="package-type neos-priority3">
              <label for="{packageKey}">
                <span class="neos-label">{package.type}</span>
              </label>
            </td>
            <td class="neos-priority1 neos-aCenter"><i class="fas fa-{f:if(condition: package.isFrozen, then: 'check', else: 'times')}"></i></td>
          </tr>
        </f:for>
      </f:for>
    </tbody>
  </table>
</div>
</f:section>

<f:section name="headerLabel">
	<f:if condition="{sortBy} === {sortingField}">
		<f:then>
			<f:if condition="{sortDirection} === 'ASC'">
				<f:then>
					<f:link.action action="index" arguments="{sortDirection: 'DESC', sortBy: sortingField}" addQueryString="TRUE">
						<neos:backend.translate id="{labelIdentifier}" source="Modules" package="Neos.Neos"/>
						<i class="fas fa-sort-amount-up"></i>
					</f:link.action>
				</f:then>
				<f:else>
					<f:link.action action="index" arguments="{sortDirection: 'ASC', sortBy: sortingField}" addQueryString="TRUE">
						<neos:backend.translate id="{labelIdentifier}" source="Modules" package="Neos.Neos"/>
						<i class="fas fa-sort-amount-down"></i>
					</f:link.action>
				</f:else>
			</f:if>
		</f:then>
		<f:else>
			<f:link.action action="index" arguments="{sortBy: sortingField}" addQueryString="TRUE">
				<neos:backend.translate id="{labelIdentifier}" source="Modules" package="Neos.Neos"/>
			</f:link.action>
		</f:else>
	</f:if>
</f:section>
